{% extends 'base.html' %}
{% block content %}
{% load static %}
<script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js'></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.9.0/fullcalendar.css" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.9.0/fullcalendar.js"></script>

<style>
  table tr td:hover {
  cursor: pointer;
}
input[type="date"]::-webkit-calendar-picker-indicator {
      filter: invert(1); /* Invert color for the calendar icon */
    }
    .btn-container {
    text-align: center; /* Center the content horizontally */
  }

  .btn-add {
    border: 2px solid orange;
    border-radius: 10px;
    width: 80px;
    display: block;
    margin: 0 auto;
    text-align: center;
    transition: background-color 0.3s ease; /* Add smooth transition effect */
}

.btn-add:hover {
    background-color: orange;
    color: white; /* Add this line to ensure text is visible on hover */
}
</style>

<body>
  <div class="body-wrapper">
    <div class="container-fluid">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="{% url 'company_dashboard' %}" class="text-warning-emphasis">Dashboard</a></li>
          <li class="breadcrumb-item"><a href="{% url 'company_attendance_list' %}" class="text-warning-emphasis">Attendance list</a></li>
          <li class="breadcrumb-item"><a href="" class="text-warning-emphasis">Overview</a></li>
        </ol>
      </nav>
      <div style="overflow-x:auto;"> 
        <div class="container-fluid bg-black" style="padding: 20px;">
          <div class="row">
            <div class="col-md-5">
              <!-- Add any content for the left column if needed -->
            </div>
            <div class="col-md-7">
              <div id='calendar'></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
        var calendarEl = document.getElementById('calendar');
        var calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: 'dayGridMonth',
            events: [
                {% for entry in emp_attendance %}
                    {
                        title: '{{ entry.status }}',
                        start: '{{ entry.date|date:"Y-m-d" }}',
                        allDay: true,
                    },
                {% endfor %}
            ],
            eventContent: function(arg) {
                var eventElement = document.createElement('div');
                eventElement.innerHTML = arg.event.title;
                eventElement.style.width = '120px';
                eventElement.style.height = '30px';
                eventElement.style.fontSize = '20px';
                eventElement.style.textTransform = 'capitalize';
                eventElement.style.marginLeft = '10px';
                return { domNodes: [eventElement] };
            },
        });

        // Extract year and month from the first entry in emp_attendance
        var yearToOpen = null;
        var monthToOpen = null;
        {% if emp_attendance %}
            yearToOpen = new Date('{{ emp_attendance.first.date|date:"Y" }}').getFullYear();
            monthToOpen = new Date('{{ emp_attendance.first.date|date:"m" }}').getMonth();
        {% endif %}

        // Open the calendar to the specified year and month
        if (yearToOpen !== null && monthToOpen !== null) {
            calendar.gotoDate(new Date(yearToOpen, monthToOpen));
        }

        calendar.render();
    });
</script>

</body>
{% endblock %}